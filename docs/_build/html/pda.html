
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Panel Data Approach &#8212; mlsynth 0.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=e1a75a79"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/static/custom_mathjax.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'pda';</script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Proximal Synthetic Control" href="proximal.html" />
    <link rel="prev" title="mlsynth.estimators.nsc.NSC" href="_autosummary/mlsynth.estimators.nsc.NSC.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">mlsynth 0.1 documentation</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Overview:</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="about.html">About mlsynth</a></li>

<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Estimators</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="clustersc.html">Cluster Synthetic Controls</a></li>
<li class="toctree-l1"><a class="reference internal" href="fdid.html">Forward Difference-in-Differences</a></li>
<li class="toctree-l1"><a class="reference internal" href="fma.html">Factor Model Approach</a></li>
<li class="toctree-l1"><a class="reference internal" href="fscm.html">Forward SCM</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="gsc.html">Generalized Synthetic Control (GSC)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/mlsynth.estimators.gsc.GSC.html">mlsynth.estimators.gsc.GSC</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="nsc.html">Nonlinear Synthetic Control (NSC)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/mlsynth.estimators.nsc.NSC.html">mlsynth.estimators.nsc.NSC</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Panel Data Approach</a></li>
<li class="toctree-l1"><a class="reference internal" href="proximal.html">Proximal Synthetic Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="scmo.html">Synthetic Control With Multiple Outcomes</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="sdid.html">Synthetic Difference-in-Differences (SDID)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/mlsynth.estimators.sdid.SDID.html">mlsynth.estimators.sdid.SDID</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="si.html">Synthetic Interventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="src.html">Synthetic Regression Control Method</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="stablesc.html">Stable Synthetic Control (StableSC)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="_autosummary/mlsynth.estimators.stablesc.StableSC.html">mlsynth.estimators.stablesc.StableSC</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="tssc.html">Two-Step Synthetic Control</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Utilities</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="datautils.html">Data Utilities (<cite>mlsynth.utils.datautils</cite>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="estutils.html">Estimation Utilities (<cite>mlsynth.utils.estutils</cite>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="inferutils.html">Inference Utilities (<cite>mlsynth.utils.inferutils</cite>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="resultutils.html">Result Utilities (<cite>mlsynth.utils.resultutils</cite>)</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/pda.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Panel Data Approach</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mlsynth.PDA"><code class="docutils literal notranslate"><span class="pre">PDA</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mlsynth.PDA.config"><code class="docutils literal notranslate"><span class="pre">PDA.config</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mlsynth.PDA.df"><code class="docutils literal notranslate"><span class="pre">PDA.df</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mlsynth.PDA.outcome"><code class="docutils literal notranslate"><span class="pre">PDA.outcome</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mlsynth.PDA.treat"><code class="docutils literal notranslate"><span class="pre">PDA.treat</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mlsynth.PDA.unitid"><code class="docutils literal notranslate"><span class="pre">PDA.unitid</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mlsynth.PDA.time"><code class="docutils literal notranslate"><span class="pre">PDA.time</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mlsynth.PDA.display_graphs"><code class="docutils literal notranslate"><span class="pre">PDA.display_graphs</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mlsynth.PDA.save"><code class="docutils literal notranslate"><span class="pre">PDA.save</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mlsynth.PDA.counterfactual_color"><code class="docutils literal notranslate"><span class="pre">PDA.counterfactual_color</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mlsynth.PDA.treated_color"><code class="docutils literal notranslate"><span class="pre">PDA.treated_color</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mlsynth.PDA.method"><code class="docutils literal notranslate"><span class="pre">PDA.method</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mlsynth.PDA.tau"><code class="docutils literal notranslate"><span class="pre">PDA.tau</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mlsynth.PDA.__init__"><code class="docutils literal notranslate"><span class="pre">PDA.__init__()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ell-2-relaxation"><span class="math notranslate nohighlight">\(\ell_2\)</span> Relaxation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#forward-selected-approach">Forward Selected Approach</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lasso-pda">LASSO PDA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#to-do-list">To-Do List</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="panel-data-approach">
<h1>Panel Data Approach<a class="headerlink" href="#panel-data-approach" title="Link to this heading">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="mlsynth.PDA">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mlsynth.</span></span><span class="sig-name descname"><span class="pre">PDA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PDAConfig</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mlsynth.PDA" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Implements the Panel Data Approach (PDA) for treatment effect estimation.</p>
<p>This class provides a unified interface to several PDA methods, including:
- <strong>LASSO (L1 Penalty):</strong> Uses L1 regularization for variable selection and</p>
<blockquote>
<div><p>estimation, as described in Li &amp; Bell (2017).</p>
</div></blockquote>
<ul class="simple">
<li><p><strong>L2-Relaxation (‘l2’):</strong> Employs L2 regularization, potentially with a
user-specified treatment effect (tau_l2), based on Shi &amp; Wang (2024).</p></li>
<li><p><strong>Forward Selection (‘fs’):</strong> Uses a forward stepwise procedure for selecting
control units, as detailed in Shi &amp; Huang (2023).</p></li>
</ul>
<p>The estimator takes panel data and a configuration object specifying the
chosen PDA method and other common parameters. The <cite>fit</cite> method then
applies the selected algorithm to estimate the treatment effect.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="mlsynth.PDA.config">
<span class="sig-name descname"><span class="pre">config</span></span><a class="headerlink" href="#mlsynth.PDA.config" title="Link to this definition">#</a></dt>
<dd><p>The configuration object holding all parameters for the estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>PDAConfig</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mlsynth.PDA.df">
<span class="sig-name descname"><span class="pre">df</span></span><a class="headerlink" href="#mlsynth.PDA.df" title="Link to this definition">#</a></dt>
<dd><p>The input DataFrame containing panel data.
(Inherited from <cite>BaseEstimatorConfig</cite> via <cite>PDAConfig</cite>)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mlsynth.PDA.outcome">
<span class="sig-name descname"><span class="pre">outcome</span></span><a class="headerlink" href="#mlsynth.PDA.outcome" title="Link to this definition">#</a></dt>
<dd><p>Name of the outcome variable column in <cite>df</cite>.
(Inherited from <cite>BaseEstimatorConfig</cite> via <cite>PDAConfig</cite>)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mlsynth.PDA.treat">
<span class="sig-name descname"><span class="pre">treat</span></span><a class="headerlink" href="#mlsynth.PDA.treat" title="Link to this definition">#</a></dt>
<dd><p>Name of the treatment indicator column in <cite>df</cite>.
(Inherited from <cite>BaseEstimatorConfig</cite> via <cite>PDAConfig</cite>)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mlsynth.PDA.unitid">
<span class="sig-name descname"><span class="pre">unitid</span></span><a class="headerlink" href="#mlsynth.PDA.unitid" title="Link to this definition">#</a></dt>
<dd><p>Name of the unit identifier column in <cite>df</cite>.
(Inherited from <cite>BaseEstimatorConfig</cite> via <cite>PDAConfig</cite>)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mlsynth.PDA.time">
<span class="sig-name descname"><span class="pre">time</span></span><a class="headerlink" href="#mlsynth.PDA.time" title="Link to this definition">#</a></dt>
<dd><p>Name of the time variable column in <cite>df</cite>.
(Inherited from <cite>BaseEstimatorConfig</cite> via <cite>PDAConfig</cite>)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mlsynth.PDA.display_graphs">
<span class="sig-name descname"><span class="pre">display_graphs</span></span><a class="headerlink" href="#mlsynth.PDA.display_graphs" title="Link to this definition">#</a></dt>
<dd><p>Whether to display graphs of results.
(Inherited from <cite>BaseEstimatorConfig</cite> via <cite>PDAConfig</cite>)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a>, default True</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mlsynth.PDA.save">
<span class="sig-name descname"><span class="pre">save</span></span><a class="headerlink" href="#mlsynth.PDA.save" title="Link to this definition">#</a></dt>
<dd><p>Configuration for saving plots.
- If <cite>False</cite> (default), plots are not saved.
- If <cite>True</cite>, plots are saved with default names in the current directory.
- If a <cite>str</cite>, it’s used as the base filename for saved plots.
- If a <cite>Dict[str, str]</cite>, it maps specific plot keys (e.g., “estimates_plot”)</p>
<blockquote>
<div><p>to full file paths.</p>
</div></blockquote>
<p>(Inherited from <cite>BaseEstimatorConfig</cite> via <cite>PDAConfig</cite>)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>]], default False</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mlsynth.PDA.counterfactual_color">
<span class="sig-name descname"><span class="pre">counterfactual_color</span></span><a class="headerlink" href="#mlsynth.PDA.counterfactual_color" title="Link to this definition">#</a></dt>
<dd><p>Color for the counterfactual line(s) in plots. Can be a single color string
or a list of color strings if multiple counterfactuals are plotted (though
PDA typically plots one).
(Inherited from <cite>BaseEstimatorConfig</cite> via <cite>PDAConfig</cite>)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, List[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>]], default “red”</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mlsynth.PDA.treated_color">
<span class="sig-name descname"><span class="pre">treated_color</span></span><a class="headerlink" href="#mlsynth.PDA.treated_color" title="Link to this definition">#</a></dt>
<dd><p>Color for the treated unit line in plots.
(Inherited from <cite>BaseEstimatorConfig</cite> via <cite>PDAConfig</cite>)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, default “black”</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mlsynth.PDA.method">
<span class="sig-name descname"><span class="pre">method</span></span><a class="headerlink" href="#mlsynth.PDA.method" title="Link to this definition">#</a></dt>
<dd><p>The PDA method to use: ‘LASSO’, ‘l2’, or ‘fs’.
(From <cite>PDAConfig</cite>)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, default “fs”</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mlsynth.PDA.tau">
<span class="sig-name descname"><span class="pre">tau</span></span><a class="headerlink" href="#mlsynth.PDA.tau" title="Link to this definition">#</a></dt>
<dd><p>User-specified treatment effect value, primarily used as <cite>tau_l2</cite>
for the ‘l2’ method.
(From <cite>PDAConfig</cite>)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)">float</a>], default None</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">References</p>
<p>Shi, Z. &amp; Huang, J. (2023). “Forward-selected panel data approach for program evaluation.”
<em>Journal of Econometrics</em>, Volume 234, Issue 2, Pages 512-535.
DOI: <a class="reference external" href="https://doi.org/10.1016/j.jeconom.2021.04.009">https://doi.org/10.1016/j.jeconom.2021.04.009</a></p>
<p>Li, Kathleen T., and David R. Bell. “Estimation of Average Treatment Effects with Panel Data:
Asymptotic Theory and Implementation.” <em>Journal of Econometrics</em> 197, no. 1 (March, 2017): 65-75.
DOI: <a class="reference external" href="https://doi.org/10.1016/j.jeconom.2016.01.011">https://doi.org/10.1016/j.jeconom.2016.01.011</a></p>
<p>Shi, Z. &amp; Wang, Y. (2024). “L2-relaxation for Economic Prediction.”
DOI: <a class="reference external" href="https://doi.org/10.13140/RG.2.2.11670.97609">https://doi.org/10.13140/RG.2.2.11670.97609</a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mlsynth.PDA.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PDAConfig</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#mlsynth.PDA.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initializes the PDA estimator with a configuration object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>PDAConfig</em>) – <p>A Pydantic model instance containing all configuration parameters
for the PDA estimator. This includes:
- df (pd.DataFrame): The input DataFrame.
- outcome (str): Name of the outcome variable column.
- treat (str): Name of the treatment indicator column.
- unitid (str): Name of the unit identifier column.
- time (str): Name of the time variable column.
- display_graphs (bool, optional): Whether to display graphs. Defaults to True.
- save (Union[bool, str, Dict[str, str]], optional): Configuration for saving plots.</p>
<blockquote>
<div><p>If <cite>False</cite> (default), plots are not saved. If <cite>True</cite>, plots are saved with
default names. If a <cite>str</cite>, it’s used as the base filename. If a <cite>Dict[str, str]</cite>,
it maps plot keys to full file paths. Defaults to False.</p>
</div></blockquote>
<ul class="simple">
<li><p>counterfactual_color (Union[str, List[str]], optional): Color for counterfactual
line(s). Defaults to “red”.</p></li>
<li><p>treated_color (str, optional): Color for treated unit line. Defaults to “black”.</p></li>
<li><p>method (str, optional): Type of PDA: ‘LASSO’, ‘l2’, or ‘fs’. Defaults to “fs”.</p></li>
<li><p>tau (Optional[float], optional): User-specified treatment effect for ‘l2’ method. Defaults to None.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<p>As with any causal study, the results we get depend on how we choose or give weight to units in the control group. Many recent developments in the causal inference literature focus on developing some linear/convex combination of untreated units to approximate the pre-intervention values of a treated unit, such  that we may learn their out of sample counterfactuals had the unit never been treated. Synthetic control methods are probably the most prevalent formulation of that idea, typically taking the form of a convex combination of donor/control units. The basic idea of the panel data approach, essentially, is that we may use unconstrained regression methods such as OLS, LASSO, or others to construct the counterfactual using (mainly) pre-intervention data. Part of the upshoot of this, as Li and van den Bulte <a class="reference internal" href="references.html#adid" id="id1"><span>[ADID]</span></a> document in their paper, is that panel data approaches are a lot more flexible than synthetic control methods, both in terms of their estimation and (occasionally) inference.  <code class="docutils literal notranslate"><span class="pre">mlsynth</span></code> implements three such implementations of the panel data approach, and there are certainly more to choose from. <code class="docutils literal notranslate"><span class="pre">mlsynth</span></code> estimates the LASSO method <a class="reference internal" href="references.html#lassopda" id="id2"><span>[LASSOPDA]</span></a>, the forward selection method <a class="reference internal" href="references.html#fspda" id="id3"><span>[fsPDA]</span></a>, and the <span class="math notranslate nohighlight">\(\ell_2\)</span>-relaxation method by <a class="reference internal" href="references.html#l2relax" id="id4"><span>[l2relax]</span></a>. The main difference between these methods is in how they select or weigh the control units. The LASSO, for example, assumes that a sparse set of coefficients driven by some common factors will be a good proxy for the out-of-sample counterfactual. Forward selection presumes the same, using a forward selection algorithm to choose the control units for the treated unit with a modified Bayesian Information Criterion to stop selection. the <span class="math notranslate nohighlight">\(\ell_2\)</span> relaxation method, instead, assumes a dense data generating process, instead minimizing the upper bound of the deviation between the treated unit and the donor pool/control group.</p>
<p>Formally, I lay out the notations. Indexed by <span class="math notranslate nohighlight">\(j\)</span>, we observe <span class="math notranslate nohighlight">\(\mathcal{N} \operatorname*{:=} \{1, 2, \ldots, N\}\)</span> units where the set <span class="math notranslate nohighlight">\(\mathcal{N}\)</span> has cardinality <span class="math notranslate nohighlight">\(N = |\mathcal{N}|\)</span>. <span class="math notranslate nohighlight">\(j = 1\)</span> is the treated unit with the controls being <span class="math notranslate nohighlight">\(\mathcal{N}_0 \operatorname*{:=} \mathcal{N} \setminus \{1\}\)</span> whose cardinality is <span class="math notranslate nohighlight">\(N_0 = |\mathcal{N}_0|\)</span>. Time periods are indexed by <span class="math notranslate nohighlight">\(t\)</span>. Let <span class="math notranslate nohighlight">\(\mathcal{T}_1 \operatorname*{:=} \{1, 2, \ldots, T_0\}\)</span> represent the pre-intervention periods, where <span class="math notranslate nohighlight">\(T_0\)</span> is the final pre-intervention period, and <span class="math notranslate nohighlight">\(\mathcal{T}_2 \operatorname*{:=} \{T_0 + 1, \ldots, T\}\)</span> represents the post-intervention periods. Both of these sets have cardinalities <span class="math notranslate nohighlight">\(T_1 = |\mathcal{T}_1|\)</span> and <span class="math notranslate nohighlight">\(T_2 = |\mathcal{T}_2|\)</span>. Let <span class="math notranslate nohighlight">\(\mathcal{T} \operatorname*{:=} \mathcal{T}_1 \cup \mathcal{T}_2\)</span> represent the full time series, with cardinality <span class="math notranslate nohighlight">\(T = |\mathcal{T}|\)</span>. Let <span class="math notranslate nohighlight">\(\mathbf{y}_1 \in \mathbb{R}^T\)</span> be the vector for the treated unit and <span class="math notranslate nohighlight">\(\mathbf{Y}_0 \in \mathbb{R}^{T \times N_0}\)</span> be the matrix for the control units that were unexposed. Furthermore, let <span class="math notranslate nohighlight">\(\boldsymbol{\beta} \in \mathbb{R}^{N_0}\)</span> be the coefficients for some controls. The sup norm of a vector <span class="math notranslate nohighlight">\(\mathbf{y} \in \mathbb{R}^N\)</span> is defined as the maximum absolute value of its components, <span class="math notranslate nohighlight">\(\|\mathbf{y}\|_\infty = \max_{j = 1, \ldots, N} |y_j|\)</span>. The floor function of a real number <span class="math notranslate nohighlight">\(x \in \mathbb{R}\)</span>, denoted <span class="math notranslate nohighlight">\(\lfloor x \rfloor\)</span>, returns <span class="math notranslate nohighlight">\(\lfloor x \rfloor = \max \{k \in \mathbb{N}_+ : k \leq x\}\)</span>.</p>
<section id="ell-2-relaxation">
<h2><span class="math notranslate nohighlight">\(\ell_2\)</span> Relaxation<a class="headerlink" href="#ell-2-relaxation" title="Link to this heading">#</a></h2>
<p>The first approach we discuss is the <span class="math notranslate nohighlight">\(\ell_2\)</span>-relaxation PDA. Much criticism has been made of sparse-models such as the LASSO or other methods designed to induce sparsity, especially in situations where the true underlying model may actually be dense <a class="reference internal" href="references.html#l2relax" id="id5"><span>[l2relax]</span></a>. In such situations, the LASSO will perform poorly for variable selection tasks because it will assign zeros to informative predictors, or even select the wrong variables altogether. As an answer to this, econometricians increasingly have experimented with the Ridge regression estimator as a tool of interest, say as Amjad et. al <a class="reference internal" href="references.html#amjad2018" id="id6"><span>[Amjad2018]</span></a> does with their Robust Synthetic Control estimator. In paticular, they argue that the primary thing of interest should be our out of sample predictions; so, imposing sparsity or nonnegative weights, while easily interpretable, may not be the best in practice.</p>
<p>Panel data approaches generally assume that there are a common set of factors that generate our outcomes of interest, which interact with units differently over time. We wish to exploit the pre-intervention correlations between the treated unit and the control units across time in order to generate our counterfactual predicitons. <span class="math notranslate nohighlight">\(\ell_2\)</span> PDA does this, per Equation 10 of the paper, with the regression model <span class="math notranslate nohighlight">\(\mathbf{y}_1 = \boldsymbol{\alpha}+ \mathbf{Y}_0\boldsymbol{\beta}+\mathbf{\epsilon}\)</span>, which as we can see includes an intercept. We first estimate the sample covariance vector between the treated unit and donor matrix and the covariance matrix of the control group (two Gram matrices). With this in mind, our optimization problem becomes:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
&amp;\min_{\boldsymbol{\beta}} \frac{1}{2} \|\boldsymbol{\beta}\|_2^2 \: \forall t \in \, \mathcal{T}_1, \quad \text{subject to } \|\boldsymbol{\eta} - \boldsymbol{\Sigma}  \boldsymbol{\beta}\|_\infty \leq \tau \\
&amp;\boldsymbol{\eta} = \frac{1}{T_1} \mathbf{Y}_0^\top \mathbf{y}_1 \\
&amp;\boldsymbol{\Sigma} = \frac{1}{T_1} \mathbf{Y}_0^\top \mathbf{Y}_0 \in \mathbb{R}^{N_0 \times N_0}
\end{aligned}\end{split}\]</div>
<p>where we seek the coefficients which minimize the predictions between the sample covariance vector and the covariance matrix of the control units. In other words, we are projecting the treated unit on to the control units. We are doing this with the sup-norm, which in this case simply places an upper bound on the deviation from the covariance vector, using the constant tau. There is a key problem here, though: as tau shrinks to 0, we approach the OLS estimator, which seeks to totally minimize the discrepancies. Of course, this will result in overfitting. So to mitigate this, Shi and Wang employ cross validation to select tau <a class="reference internal" href="references.html#l2relax" id="id7"><span>[l2relax]</span></a>, and I follow them here. To this end, I divide the pre-intervention data into a training period and a validation periods.</p>
<div class="math notranslate nohighlight">
\[\mathcal{T}_1 = \mathcal{T}_1^{\text{train}} \cup \mathcal{T}_1^{\text{val}}, \quad
\mathcal{T}_1^{\text{train}} \cap \mathcal{T}_1^{\text{val}} = \emptyset.\]</div>
<p>Let the final period of the training in the in sample data be denoted as <span class="math notranslate nohighlight">\(k = \left\lfloor \frac{T_1}{2} \right\rfloor\)</span>,</p>
<div class="math notranslate nohighlight">
\[\mathcal{T}_1^{\text{train}} = \{1, 2, \ldots, k\}, \quad
\mathcal{T}_1^{\text{val}} = \{k+1, \ldots, T_0\}.\]</div>
<p>For our purposes, we are concerned with the value for tau that minimizes the MSE for the validation period</p>
<div class="math notranslate nohighlight">
\[\tau^{\ast} = \operatorname*{argmin}_{\tau} \left( \frac{1}{|\mathcal{T}_1^{\text{val}}|} \| \mathbf{y}^{\ell_2} - \mathbf{y}_1 \|_2^2 \right).\]</div>
<p>The predictions for the validation period take the form</p>
<div class="math notranslate nohighlight">
\[\mathbf{y}^{\ell_2} = \mathbf{Y}_0^{\text{val}}\boldsymbol{\beta}^{\ell_2}+\boldsymbol{\alpha},\]</div>
<p>The code below replicates <a class="reference internal" href="references.html#l2relax" id="id8"><span>[l2relax]</span></a> who themselves are replicating <a class="reference internal" href="references.html#hcw" id="id9"><span>[HCW]</span></a>. The goal is to see how the year over year growth rate of Hong Kong’s GDP would have evolved had it not become economically integrated with the mainland of China.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">mlsynth.mlsynth</span><span class="w"> </span><span class="kn">import</span> <span class="n">PDA</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="n">file</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/jgreathouse9/mlsynth/refs/heads/main/basedata/HongKong.csv&#39;</span>
<span class="c1"># Load the CSV file using pandas</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

<span class="n">treat</span> <span class="o">=</span> <span class="s2">&quot;Integration&quot;</span>
<span class="n">outcome</span> <span class="o">=</span> <span class="s2">&quot;GDP&quot;</span>
<span class="n">unitid</span> <span class="o">=</span> <span class="s2">&quot;Country&quot;</span>
<span class="n">time</span> <span class="o">=</span> <span class="s2">&quot;Time&quot;</span>

<span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;df&quot;</span><span class="p">:</span> <span class="n">df</span><span class="p">,</span>
    <span class="s2">&quot;treat&quot;</span><span class="p">:</span> <span class="n">treat</span><span class="p">,</span>
    <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="n">time</span><span class="p">,</span>
    <span class="s2">&quot;outcome&quot;</span><span class="p">:</span> <span class="n">outcome</span><span class="p">,</span>
    <span class="s2">&quot;unitid&quot;</span><span class="p">:</span> <span class="n">unitid</span><span class="p">,</span>
    <span class="s2">&quot;display_graphs&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;l2&quot;</span>
<span class="p">}</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">PDA</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>

<span class="n">arco</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
<p>When we estimate the counterfactual, we get</p>
<a class="reference internal image-reference" href="https://raw.githubusercontent.com/jgreathouse9/mlsynth/main/examples/l2relax/HK_Integration.png"><img alt="Counterfactual Hong Kong" class="align-center" src="https://raw.githubusercontent.com/jgreathouse9/mlsynth/main/examples/l2relax/HK_Integration.png" style="width: 600px;" />
</a>
</section>
<section id="forward-selected-approach">
<h2>Forward Selected Approach<a class="headerlink" href="#forward-selected-approach" title="Link to this heading">#</a></h2>
<p>Next I describe the forward-selection PDA implemented by <code class="docutils literal notranslate"><span class="pre">mlsynth</span></code>. In fsPDA, the control group is selected using forward selection. The selection method iteratively chooses control units to maximize the model’s explanatory power based on the <span class="math notranslate nohighlight">\(R^2\)</span> statistic.</p>
<p>We begin with an empty set of selected control units <span class="math notranslate nohighlight">\(\hat{U}_0 = \emptyset\)</span>. Our iterations span <span class="math notranslate nohighlight">\(r = {1, 2, \ldots, R}\)</span>. For the first iteration, we estimate a single OLS regression model per each control unit <span class="math notranslate nohighlight">\(j \in \mathcal{N}_0 \setminus \hat{U}_{r-1}\)</span>. In this instance,  <span class="math notranslate nohighlight">\(\mathbf{y}_1\)</span> is predicted by the set of previously selected controls <span class="math notranslate nohighlight">\(\mathbf{Y}_{\hat{U}_{r-1}}\)</span> plus the candidate control unit <span class="math notranslate nohighlight">\(\mathbf{y}_j\)</span>. After our first iteration, we select the control unit <span class="math notranslate nohighlight">\(j_r\)</span> that maximizes the <span class="math notranslate nohighlight">\(R^2\)</span> of the regression. We then update the selected set: <span class="math notranslate nohighlight">\(\hat{U}_r = \hat{U}_{r-1} \cup \{j_r\}\)</span>. The next model proceeds the same way, including the originally selected unit. The process stops after <span class="math notranslate nohighlight">\(R\)</span> iterations, where <span class="math notranslate nohighlight">\(R\)</span> is chosen by a modified Bayesian Information Criterion as described by Shi and Huang (2023) <a class="reference internal" href="references.html#fspda" id="id10"><span>[fsPDA]</span></a>.</p>
<p>After selecting the control group, the counterfactual for the treated unit is predicted using the following regression model:</p>
<div class="math notranslate nohighlight">
\[(\hat{\alpha}, \hat{\boldsymbol{\beta}}_{\hat{U}_r}) = \operatorname*{argmin}_{\alpha, \boldsymbol{\beta}_{\hat{U}_r}}
\|\mathbf{y}_1 - \mathbf{Y}_{\hat{U}_r} \boldsymbol{\beta}_{\hat{U}_r}- \alpha\|_2^2.\]</div>
<p>Here is the example repeated above, except with the forward selection PDA. Note that all we needed to do is just change around a few parameters, instead of needing to switch softwares or learn a new syntax.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

<span class="c1"># Update the method</span>
<span class="n">config</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;fs&quot;</span>

<span class="c1"># Create the &#39;fsPDA&#39; directory</span>
<span class="n">save_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s2">&quot;fsPDA&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">save_directory</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">save_directory</span><span class="p">)</span>

<span class="c1"># Update the save file</span>
<span class="n">config</span><span class="p">[</span><span class="s2">&quot;save&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;filename&quot;</span><span class="p">:</span> <span class="s2">&quot;HK_Integration_fs&quot;</span><span class="p">,</span>
    <span class="s2">&quot;extension&quot;</span><span class="p">:</span> <span class="s2">&quot;png&quot;</span><span class="p">,</span>
    <span class="s2">&quot;directory&quot;</span><span class="p">:</span> <span class="n">save_directory</span>
<span class="p">}</span>

<span class="c1"># Initialize the model with forward selection</span>
<span class="n">model_fs</span> <span class="o">=</span> <span class="n">PDA</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>

<span class="c1"># Fit the fsPDA model</span>
<span class="n">autores_fs</span> <span class="o">=</span> <span class="n">model_fs</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="https://raw.githubusercontent.com/jgreathouse9/mlsynth/main/examples/fsPDA/HK_Integration_fs.png"><img alt="Counterfactual Hong Kong" class="align-center" src="https://raw.githubusercontent.com/jgreathouse9/mlsynth/main/examples/fsPDA/HK_Integration_fs.png" style="width: 600px;" />
</a>
</section>
<section id="lasso-pda">
<h2>LASSO PDA<a class="headerlink" href="#lasso-pda" title="Link to this heading">#</a></h2>
<p>The objective function for LASSO’s PDA is given by:</p>
<div class="math notranslate nohighlight">
\[\hat{\boldsymbol{\beta}} = \operatorname*{argmin}_{\boldsymbol{\beta}} \|\mathbf{y}_1 - \mathbf{Y}_0 \boldsymbol{\beta}\|_2^2 + \lambda \|\boldsymbol{\beta}\|_1,\]</div>
<p>In this PDA, we simply use the LASSO to choose the control units, as implemented by <code class="docutils literal notranslate"><span class="pre">sklearn</span></code>.</p>
<p>This code, implemented like</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>

<span class="c1"># Update the method to &quot;LASSO&quot; for LASSO-based PDA</span>
<span class="n">config</span><span class="p">[</span><span class="s2">&quot;method&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;LASSO&quot;</span>

<span class="c1"># Create the &#39;L1PDA&#39; directory for saving results</span>
<span class="n">save_directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s2">&quot;L1PDA&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">save_directory</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">save_directory</span><span class="p">)</span>

<span class="c1"># Update the save configuration</span>
<span class="n">config</span><span class="p">[</span><span class="s2">&quot;save&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;filename&quot;</span><span class="p">:</span> <span class="s2">&quot;HK_Integration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;extension&quot;</span><span class="p">:</span> <span class="s2">&quot;png&quot;</span><span class="p">,</span>
    <span class="s2">&quot;directory&quot;</span><span class="p">:</span> <span class="n">save_directory</span>
<span class="p">}</span>

<span class="c1"># Initialize the model with LASSO-based PDA</span>
<span class="n">model_fs</span> <span class="o">=</span> <span class="n">PDA</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>

<span class="c1"># Fit the model using LASSO-based PDA</span>
<span class="n">LASSO_est</span> <span class="o">=</span> <span class="n">model_fs</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
<p>returns this plot</p>
<a class="reference internal image-reference" href="https://raw.githubusercontent.com/jgreathouse9/mlsynth/main/examples/L1PDA/HK_Integration.png"><img alt="Counterfactual Hong Kong" class="align-center" src="https://raw.githubusercontent.com/jgreathouse9/mlsynth/main/examples/L1PDA/HK_Integration.png" style="width: 600px;" />
</a>
</section>
<section id="to-do-list">
<h2>To-Do List<a class="headerlink" href="#to-do-list" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Multiple treated units for the <span class="math notranslate nohighlight">\(\ell_2\)</span> approach</p></li>
<li><p>Maybe implement HCW for comparison’s sake.</p></li>
<li><p>Maybe implement more PDAs, since quite a few exist…</p></li>
</ul>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="_autosummary/mlsynth.estimators.nsc.NSC.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">mlsynth.estimators.nsc.NSC</p>
      </div>
    </a>
    <a class="right-next"
       href="proximal.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Proximal Synthetic Control</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mlsynth.PDA"><code class="docutils literal notranslate"><span class="pre">PDA</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mlsynth.PDA.config"><code class="docutils literal notranslate"><span class="pre">PDA.config</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mlsynth.PDA.df"><code class="docutils literal notranslate"><span class="pre">PDA.df</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mlsynth.PDA.outcome"><code class="docutils literal notranslate"><span class="pre">PDA.outcome</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mlsynth.PDA.treat"><code class="docutils literal notranslate"><span class="pre">PDA.treat</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mlsynth.PDA.unitid"><code class="docutils literal notranslate"><span class="pre">PDA.unitid</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mlsynth.PDA.time"><code class="docutils literal notranslate"><span class="pre">PDA.time</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mlsynth.PDA.display_graphs"><code class="docutils literal notranslate"><span class="pre">PDA.display_graphs</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mlsynth.PDA.save"><code class="docutils literal notranslate"><span class="pre">PDA.save</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mlsynth.PDA.counterfactual_color"><code class="docutils literal notranslate"><span class="pre">PDA.counterfactual_color</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mlsynth.PDA.treated_color"><code class="docutils literal notranslate"><span class="pre">PDA.treated_color</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mlsynth.PDA.method"><code class="docutils literal notranslate"><span class="pre">PDA.method</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mlsynth.PDA.tau"><code class="docutils literal notranslate"><span class="pre">PDA.tau</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mlsynth.PDA.__init__"><code class="docutils literal notranslate"><span class="pre">PDA.__init__()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ell-2-relaxation"><span class="math notranslate nohighlight">\(\ell_2\)</span> Relaxation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#forward-selected-approach">Forward Selected Approach</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lasso-pda">LASSO PDA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#to-do-list">To-Do List</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jared Greathouse
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025, Jared Greathouse.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>